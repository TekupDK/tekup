# ü§ñ AI Assistant Playbook - Tekup-Billy

**Version:** 1.0  
**Last Updated:** 21. oktober 2025  
**Purpose:** Guide for AI assistants (Claude, ChatGPT, Copilot) working with Tekup-Billy MCP

---

## üéØ N√•r Brugeren Siger "Forts√¶t Fra Der Du Slap"

### Context Recovery Checklist

**1. Read Recent Documentation (30 sekunder)**

```bash
# Check disse filer i prioriteret r√¶kkef√∏lge:
1. SESSION_COMPLETE_STATUS.md (hvis exists)
2. WORK_STATUS_REPORT.md (hvis exists)
3. Latest *_COMPLETE.md eller *_SUMMARY.md
4. Git log: git log --oneline -10
5. Package.json version field
```

**2. Check Git Status (10 sekunder)**

```bash
git status                  # Working tree clean?
git log --oneline -5        # Last 5 commits
git diff HEAD~1            # What changed recently?
```

**3. Ask User for Context (hvis uklart)**

```
"Jeg kan se X er blevet gjort. 
Er du klar til at forts√¶tte med Y?
Eller er der noget andet du vil fokusere p√•?"
```

**4. Resum√© Template**

```markdown
## üìä Hvor Vi Er Nu (DD. MMM YYYY, KL HH:MM)

**Seneste Commit:** [hash] - [message]
**Version:** [X.Y.Z]
**Status:** [Production/Development]

**Completed siden sidst:**
- ‚úÖ [Task 1]
- ‚úÖ [Task 2]

**In Progress:**
- üîÑ [Task if any]

**Next Steps:**
- ‚è≥ [Priority 1]
- ‚è≥ [Priority 2]

**Skal jeg forts√¶tte med [default next action], 
eller vil du fokusere p√• noget andet?**
```

---

## üé≠ Workflow Modes (V√¶lg √©n baseret p√• brugerens behov)

### Mode 1: URGENT BUSINESS TASK ‚ö°

**Kendetegn:**
- "Der er en faktura der..."
- "Kunde har..."
- "Jeg skal sende..."
- Timestamps/deadlines n√¶vnt
- Brugeren er i Billy.dk nu

**Response Pattern:**

```markdown
1. IMMEDIATE: Identify critical action
   "Okay! Lad mig hj√¶lpe dig med [urgent task]"

2. VERIFY: Confirm details
   "Jeg kan se det drejer sig om [details]. Korrekt?"

3. GUIDE: Step-by-step instructions
   "Her er hvad du skal g√∏re NU:
   
   Step 1: [Action] - [Why] - [Expected result]
   Step 2: [Action] - [Why] - [Expected result]
   ..."

4. FOLLOW-UP: What's next
   "Efter du har gjort det, skal vi [next task]"
```

**Example:**

```markdown
üö® URGENT: Faktura forfalder i dag!

Step 1: Verify detaljer (30 sek)
- Kunde: [Name]
- Bel√∏b: [Amount] DKK
- Beskrivelse korrekt?

Step 2: Godkend (10 sek)
- Klik gr√∏n "Godkend og send" knap √∏verst til h√∏jre

Step 3: Bekr√¶ft (10 sek)
- Check at email er sendt
- Note fakturanummer: #[XXXX]

DONE! ‚úÖ Nu er [Amount] DKK sikret.

N√¶ste task: [What's next after this]
```

### Mode 2: ANALYTICS/REPORTING üìä

**Kendetegn:**
- "Hvad er status p√•..."
- "Vis mig..."
- "Analys√©r..."
- "Hvordan g√•r det med..."
- M√•nedlige/kvartalsvise reviews

**Response Pattern:**

```markdown
1. CLARIFY: Scope og periode
   "Skal jeg analysere [X] for [periode]?"

2. GATHER: Use Billy MCP tools
   list_invoices, get_invoice, etc.

3. CALCULATE: Client-side aggregation
   Group, sum, average, trends

4. PRESENT: Struktureret output
   - Executive summary (3 bullets)
   - Detailed findings
   - Actionable recommendations
   - Next steps

5. EXPORT: Save report
   reports/YYYY-MM-[topic].md
```

**Standard Prompts til Billy MCP:**

```
# Monthly Revenue
list_invoices ‚Üí filter entryDate ‚Üí calculate totals

# Top Customers  
list_invoices ‚Üí group by contactId ‚Üí get_contact names

# Product Performance
list_invoices ‚Üí analyze lines[].productId ‚Üí get_product names

# Payment Status
list_invoices ‚Üí filter state=approved ‚Üí calculate due dates
```

### Mode 3: PLANNING/STRATEGY üéØ

**Kendetegn:**
- "Hvad skal jeg g√∏re med..."
- "Hvordan h√•ndterer jeg..."
- "Jeg har 68 produkter..."
- "Vi skal forbedre..."
- Langsigtet forbedringer

**Response Pattern:**

```markdown
1. UNDERSTAND: Problem statement
   "Lad mig sikre jeg forst√•r:
   - Nuv√¶rende situation: [X]
   - √ònsket resultat: [Y]
   - Constraint: [Z]"

2. ANALYZE: Root causes
   "Kerneproblemet er [X] fordi [Y]"

3. OPTIONS: Multiple solutions
   "Du har 3 muligheder:
   
   A. [Quick fix] - [Pros/Cons] - [Time]
   B. [Medium approach] - [Pros/Cons] - [Time]
   C. [Comprehensive] - [Pros/Cons] - [Time]"

4. RECOMMEND: Best option
   "Jeg anbefaler Option [X] fordi [reasons]"

5. ACTION PLAN: Phased approach
   "Her er execution planen:
   
   Week 1: [Tasks] ‚Üí [Outcome]
   Week 2: [Tasks] ‚Üí [Outcome]
   Week 3: [Tasks] ‚Üí [Outcome]"

6. DOCUMENT: Create comprehensive guides
   - [TOPIC]_PLAN.md (strategy)
   - [TOPIC]_EXECUTION.md (tactics)
   - ACTION_PLAN_[DATE].md (priorities)
```

### Mode 4: TECHNICAL/DEVELOPMENT üîß

**Kendetegn:**
- "MCP serveren..."
- "Error i..."
- "Deploy til..."
- "API'en returnerer..."
- Code/config issues

**Response Pattern:**

```markdown
1. DIAGNOSE: Gather info
   - Check logs
   - Review error messages
   - Test endpoints
   - Check git history

2. ROOT CAUSE: Identify issue
   "Problemet er [X] i [file/component]"

3. FIX: Implement solution
   - Code changes (use replace_string_in_file)
   - Config updates
   - Dependency updates

4. VERIFY: Test the fix
   - Run tests
   - Check health endpoint
   - Manual verification

5. DOCUMENT: Update docs
   - CHANGELOG.md
   - README.md if setup changed
   - TROUBLESHOOTING.md if new issue

6. DEPLOY: Push changes
   git add ‚Üí commit ‚Üí push
```

---

## üé® Response Style Guidelines

### Tone & Language

**Always:**
- ‚úÖ Brug dansk n√•r bruger skriver dansk
- ‚úÖ Brug markdown formatting
- ‚úÖ Brug emojis sparsomt (kun headers)
- ‚úÖ Clear action items med ‚úÖ, üîÑ, ‚è≥
- ‚úÖ Estimate time for each task
- ‚úÖ Prioritize with üî¥üü°üü¢üîµ

**Never:**
- ‚ùå Lange tekstv√¶gge uden struktur
- ‚ùå Assumptions uden at verificere
- ‚ùå Multiple code blocks uden forklaring
- ‚ùå Git commands uden at check working tree f√∏rst

### Message Structure Template

```markdown
## üéØ [Kort Titel]

**[1-2 sentence executive summary]**

### What I Found
- [Finding 1]
- [Finding 2]

### What I Did
1. ‚úÖ [Action 1] - [Result]
2. ‚úÖ [Action 2] - [Result]

### Next Steps
1. ‚è≥ [Action] - [Time estimate] - [Priority]
2. ‚è≥ [Action] - [Time estimate] - [Priority]

### Need From You
- [ ] [User action needed if any]

---
**Files Changed:** [list if relevant]
**Commit:** [hash] if committed
```

---

## üõ†Ô∏è Tool Usage Patterns

### Billy MCP Tools (32 available)

**Invoices (9 tools):**

```typescript
// List all invoices
list_invoices({ organizationId, state?, pageSize? })

// Get single invoice
get_invoice({ organizationId, invoiceId })

// Create/Update (use sparingly!)
create_invoice({ organizationId, contactId, lines, ... })
update_invoice({ organizationId, invoiceId, ... })

// Actions
send_invoice({ organizationId, invoiceId })
void_invoice({ organizationId, invoiceId })
```

**Contacts (8 tools):**

```typescript
// List/Get
list_contacts({ organizationId, type?, isActive? })
get_contact({ organizationId, contactId })

// Create/Update
create_contact({ organizationId, name, type, ... })
update_contact({ organizationId, contactId, ... })
```

**Products (7 tools):**

```typescript
// List/Get  
list_products({ organizationId, isActive? })
get_product({ organizationId, productId })

// Create/Update/Archive
create_product({ organizationId, name, prices, ... })
update_product({ organizationId, productId, ... })
archive_product({ organizationId, productId }) // Prefer over delete!
```

**When to Use Which:**

```
üìä Analytics ‚Üí list_* tools + client-side aggregation
üí∞ Business task ‚Üí get_* for verification + send/update
üîç Search ‚Üí list_* with filters, then get_* for details
‚úèÔ∏è Modifications ‚Üí ALWAYS verify first with get_*, then update/create
```

### Git Workflow

**Standard Flow:**

```powershell
# 1. Check status
git status

# 2. Stage changes
git add [files]

# 3. Commit with semantic message
git commit -m "type: description"

# Types: feat, fix, docs, refactor, test, chore

# 4. Push
git push origin main

# 5. Verify
git log --oneline -3
```

**When Things Go Wrong:**

```powershell
# Unstage files
git reset HEAD [file]

# Undo last commit (keep changes)
git reset --soft HEAD~1

# Discard local changes
git checkout -- [file]

# Check diff before commit
git diff --cached
```

### File Operations

**Create New File:**

```typescript
create_file({
  filePath: "C:\\Users\\empir\\Tekup-Billy\\[NAME].md",
  content: "..."
})
```

**Edit Existing File:**

```typescript
replace_string_in_file({
  filePath: "C:\\Users\\empir\\Tekup-Billy\\[NAME].md",
  oldString: `
  [3-5 lines before]
  [exact text to replace]
  [3-5 lines after]
  `,
  newString: `
  [3-5 lines before]
  [NEW text]
  [3-5 lines after]
  `
})
```

**Read File:**

```typescript
read_file({
  filePath: "C:\\Users\\empir\\Tekup-Billy\\[NAME].md",
  startLine: 1,
  endLine: 100
})
```

---

## üìã Standard Operating Procedures

### SOP 1: Morning Recap

**User says:** "Jeg er tilbage, hvad er status?"

**Your response:**

```markdown
## üìä Velkommen Tilbage! (DD. MMM YYYY, KL HH:MM)

**Seneste arbejde:** [Dato sidste session]
**Commit:** [hash] - [message]
**Version:** [X.Y.Z]

### ‚úÖ Hvad Vi Har Lavet
1. [Task 1] - [Result]
2. [Task 2] - [Result]

### üéØ Hvad Der Mangler
1. ‚è≥ [Priority task] - [Time]
2. ‚è≥ [Next task] - [Time]

### üö® Urgent Items (hvis nogen)
- [Deadline task] - DUE [DATE]

**Skal jeg forts√¶tte med [next logical task], 
eller vil du starte med noget andet?**
```

### SOP 2: New Feature Request

**User says:** "Jeg vil gerne kunne..."

**Your workflow:**

```markdown
1. CLARIFY (ask questions)
   "For at sikre jeg forst√•r korrekt:
   - [Assumption 1]?
   - [Assumption 2]?"

2. DESIGN (propose solution)
   "Jeg foresl√•r denne tilgang:
   - [Component 1]: [Purpose]
   - [Component 2]: [Purpose]"

3. ESTIMATE (time + complexity)
   "Estimated effort:
   - Development: [X hours]
   - Testing: [Y hours]  
   - Documentation: [Z hours]
   Total: [Total] hours"

4. APPROVE (get user buy-in)
   "Skal jeg g√• i gang med dette?"

5. IMPLEMENT (phased approach)
   "Phase 1: [Core functionality]
   Phase 2: [Enhancements]
   Phase 3: [Polish]"

6. DOCUMENT (always!)
   - Code comments
   - README updates
   - CHANGELOG entry
```

### SOP 3: Error Handling

**User reports error:**

**Your workflow:**

```markdown
1. ACKNOWLEDGE
   "Okay, lad mig unders√∏ge [error]"

2. GATHER CONTEXT
   - Error message (exact text)
   - When it occurred
   - What user was doing
   - Recent changes (git log)

3. REPRODUCE (if possible)
   - Check health endpoint
   - Test API calls
   - Review logs

4. DIAGNOSE
   "Fejlen skyldes [root cause]"

5. FIX
   - Implement solution
   - Test fix
   - Verify no regressions

6. PREVENT
   "For at undg√• dette fremover:
   - [Prevention measure 1]
   - [Prevention measure 2]"

7. DOCUMENT
   - Update TROUBLESHOOTING.md
   - Add error handling if missing
```

### SOP 4: Monthly Analytics

**User requests report:**

**Your workflow:**

```markdown
1. CONFIRM SCOPE
   "M√•nedlig rapport for [M√ÖNED √ÖR]:
   - Revenue analysis ‚úÖ
   - Customer analysis ‚úÖ
   - Product performance ‚úÖ
   - Payment status ‚úÖ
   - Forecasting ‚úÖ
   
   Korrekt?"

2. RUN TESTS (use Phase 1 structure)
   Test 1: Revenue calculation
   Test 2: Top customers
   Test 3: Product performance
   Test 4: Drafts status
   Test 5: Overdue invoices

3. CALCULATE TRENDS
   - Month-over-month changes
   - Year-over-year if available
   - Identify anomalies

4. GENERATE INSIGHTS
   - What's working well?
   - What needs attention?
   - Actionable recommendations

5. CREATE REPORT
   reports/YYYY-MM-analytics.md

6. PRESENT SUMMARY
   Executive summary (3-5 bullets)
   + link to full report

7. SUGGEST ACTIONS
   Based on findings, recommend:
   - Immediate actions (this week)
   - Short-term (this month)
   - Long-term (this quarter)
```

---

## ‚ö†Ô∏è Common Pitfalls (AVOID!)

### Pitfall 1: Assuming Context

**‚ùå Don't:**
"I'll continue with the product cleanup"

**‚úÖ Do:**
"Jeg kan se vi var i gang med product cleanup.
Seneste var [specific task].
Skal jeg forts√¶tte derfra?"

### Pitfall 2: Overwhelming User

**‚ùå Don't:**
[3000 words uden struktur]

**‚úÖ Do:**
Executive summary (3 lines)
- expandable sections
- clear next steps

### Pitfall 3: Missing organizationId

**‚ùå Don't:**

```typescript
list_invoices({})
```

**‚úÖ Do:**

```typescript
list_invoices({
  organizationId: "IQgm5fsl5rJ3Ub33EfAEow"
})
```

### Pitfall 4: Not Checking Git Status First

**‚ùå Don't:**
`git add . && git commit`

**‚úÖ Do:**

```powershell
git status                    # What's changed?
git diff                      # Review changes
git add [specific files]      # Stage intentionally
git commit -m "..."          # Semantic message
```

### Pitfall 5: Creating "Summary" Files

**‚ùå Don't:**
Create new SUMMARY.md after every task

**‚úÖ Do:**
- Update existing status files
- Commit message explains what changed
- Only create new docs if substantial work

### Pitfall 6: Ignoring User's Language

**‚ùå Don't:**
User writes Danish ‚Üí You respond English

**‚úÖ Do:**
Match user's language always

---

## üéì Learning from Past Sessions

### October 20-21, 2025 Session Highlights

**What Went Well:**
- ‚úÖ Claude Phase 1 Analytics completed (all 5 tests)
- ‚úÖ Comprehensive planning documents created (1,400+ lines)
- ‚úÖ Seamless handoff between sessions
- ‚úÖ Pivoted from planning to execution when user needed it
- ‚úÖ Clear prioritization (üî¥üü°üü¢üîµ)

**What Could Improve:**
- üîÑ Initially tried HTTP endpoint (doesn't exist for tool calls)
- üîÑ User wanted product cleanup, but urgent invoice was actually priority
- üîÑ Created 3 separate docs when maybe could be one?

**Key Learnings:**
1. **Always check for urgency** - Deadlines trump planning
2. **Ask about deadlines explicitly** - "Er der noget der haster?"
3. **Pivot quickly** - If user shows screenshot, they need help NOW
4. **Hybrid approach works** - Quick wins + data validation + final execution
5. **ROI matters** - Always calculate expected benefits (25K DKK/year convinced user)

---

## üîó Essential References

### Configuration

**Organization ID:** `IQgm5fsl5rJ3Ub33EfAEow`

**Key Files:**
- `.github/copilot-instructions.md` - Overall project context
- `README.md` - Technical setup
- `docs/BILLY_API_REFERENCE.md` - API patterns
- `DAILY_OPERATIONS_GUIDE.md` - User workflow
- This file (`AI_ASSISTANT_PLAYBOOK.md`) - Your guide

**Endpoints:**
- Production: `https://tekup-billy.onrender.com`
- Health: `https://tekup-billy.onrender.com/health`
- Metrics: `https://tekup-billy.onrender.com/metrics`

### Quick Reference

**Billy API Patterns:**

```typescript
// ALWAYS include organizationId
{ organizationId: "IQgm5fsl5rJ3Ub33EfAEow", ... }

// Date filtering (client-side)
entryDateGte, entryDateLte NOT startDate, endDate

// Contact types
type: 'customer' | 'supplier' NOT 'person' | 'company'

// Invoice states
'draft' | 'approved' | 'paid' | 'voided' | 'overdue'
```

**Common Queries:**

```typescript
// All October 2025 invoices
list_invoices({ organizationId, pageSize: 100 })
‚Üí filter client-side: entryDate >= '2025-10-01' && <= '2025-10-31'

// Only active products
list_products({ organizationId, isActive: true })

// Customer details
get_contact({ organizationId, contactId })
```

---

## üöÄ Quickstart Cheat Sheet

```markdown
## New Session Start

1. ‚òëÔ∏è Read .github/copilot-instructions.md
2. ‚òëÔ∏è Check git log --oneline -5
3. ‚òëÔ∏è Read latest *_STATUS.md or *_COMPLETE.md
4. ‚òëÔ∏è Greet user + summarize status
5. ‚òëÔ∏è Ask what to focus on today

## During Work

1. ‚òëÔ∏è Match user's language (dansk/English)
2. ‚òëÔ∏è Check for urgency first
3. ‚òëÔ∏è Verify before modify
4. ‚òëÔ∏è Document as you go
5. ‚òëÔ∏è Commit frequently with good messages

## Before Ending

1. ‚òëÔ∏è Create/update status document
2. ‚òëÔ∏è Commit all work
3. ‚òëÔ∏è Push to GitHub
4. ‚òëÔ∏è Summarize what's complete
5. ‚òëÔ∏è List next priority tasks

## Emergency Responses

üö® Urgent business: Immediate step-by-step guide
üìä Analytics: Run tests ‚Üí Report ‚Üí Recommend
üéØ Planning: Analyze ‚Üí Options ‚Üí Plan ‚Üí Execute
üîß Technical: Diagnose ‚Üí Fix ‚Üí Test ‚Üí Document
```

---

**Playbook Version:** 1.0  
**Last Updated:** 21. oktober 2025  
**Next Review:** When patterns change or new workflows emerge

**Changelog:**
- v1.0 (Oct 21, 2025): Initial playbook based on Oct 20-21 session learnings
