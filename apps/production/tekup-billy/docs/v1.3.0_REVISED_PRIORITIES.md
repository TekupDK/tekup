# 🎯 v1.3.0 Revised Feature Priorities

**Date:** October 14, 2025  
**Status:** Post-Technical Review Adjustments  
**Confidence:** 90% (up from 85%)  

---

## 📋 **PRIORITY MATRIX**

### **🔴 CRITICAL (Must-Have for v1.3.0 Launch)**

#### **1. Core Infrastructure** (Week 1)

**Priority:** P0 - Launch Blocker  
**Risk:** Low  
**Effort:** 3 days  

- [ ] Database schema migration (002_v1.3.0_additions.sql)
- [ ] Redis Cloud setup for Bull queues
- [ ] Update existing cache tables with TTL columns
- [ ] Deploy schema to Supabase production

**Success Criteria:**
- 14 total Supabase tables operational
- Redis connection tested and working
- Zero schema deployment errors

---

#### **2. Bank Payments Endpoint** (Week 1)

**Priority:** P0 - High Business Value  
**Risk:** Low  
**Effort:** 1 day  

- [ ] `/v2/bankPayments` Billy.dk API client
- [ ] `list_bank_payments` MCP tool
- [ ] `get_bank_payment` MCP tool
- [ ] `create_bank_payment` MCP tool
- [ ] Supabase caching integration

**Success Criteria:**
- 3 new MCP tools functional
- API response time <100ms (cached)
- Unit tests passing

---

#### **3. File Management Endpoint** (Week 1)

**Priority:** P0 - Enables Document Workflows  
**Risk:** Medium (binary file handling)  
**Effort:** 1 day  

- [ ] `/v2/files` Billy.dk API client
- [ ] `upload_file` MCP tool (with multipart support)
- [ ] `list_files` MCP tool
- [ ] `download_file` MCP tool
- [ ] File metadata caching (not binary data)

**Success Criteria:**
- File upload/download working
- Supports PDF, images, Excel
- Max file size: 10MB

---

#### **4. Analytics Dashboard MVP** (Week 2)

**Priority:** P0 - Visibility into System  
**Risk:** Medium (UI complexity)  
**Effort:** 5 days  

**Core Features:**
- [ ] Next.js app with Tailwind CSS
- [ ] Performance metrics chart (Recharts)
- [ ] Cache statistics cards
- [ ] Real-time activity feed (Supabase subscriptions)
- [ ] Mobile responsive design

**Success Criteria:**
- Dashboard loads <2 seconds
- Real-time updates <1s latency
- Works on mobile devices

---

#### **5. Bulk CSV Import/Export** (Week 3)

**Priority:** P0 - High User Demand  
**Risk:** Low  
**Effort:** 3 days  

**Scope (Customers & Products Only):**
- [ ] CSV parser with validation (PapaParse + Zod)
- [ ] `import_customers_csv` MCP tool
- [ ] `import_products_csv` MCP tool
- [ ] `export_customers_csv` MCP tool
- [ ] `export_products_csv` MCP tool
- [ ] Real-time progress tracking UI

**Success Criteria:**
- Import 1000 customers in <2 minutes
- Validation catches 95%+ errors
- Progress updates every second

---

#### **6. Dynamic TTL Caching** (Week 4)

**Priority:** P0 - Performance Critical  
**Risk:** Low (simplified from ML)  
**Effort:** 2 days  

**Simplified Approach (No ML):**
- [ ] Frequency-based TTL calculation
- [ ] Access count tracking
- [ ] Cache warming for frequent items
- [ ] Automatic expiration management

**Success Criteria:**
- 75-80% cache hit rate (up from 68%)
- <100ms average response time maintained
- Simple rule-based logic (no ML complexity)

---

### **🟡 HIGH PRIORITY (Should-Have for v1.3.0)**

#### **7. Bills Endpoint** (Week 2)

**Priority:** P1 - Completes Accounting Workflow  
**Risk:** Low  
**Effort:** 1 day  

- [ ] `/v2/bills` Billy.dk API client
- [ ] `list_bills`, `get_bill`, `create_bill` MCP tools
- [ ] Supabase caching

---

#### **8. Organizations Endpoint** (Week 2)

**Priority:** P1 - Multi-Company Support  
**Risk:** Low  
**Effort:** 0.5 days  

- [ ] `/v2/organizations` Billy.dk API client
- [ ] `get_organization`, `update_organization` MCP tools
- [ ] Settings caching

---

#### **9. Contact Persons Endpoint** (Week 3)

**Priority:** P1 - Customer Management  
**Risk:** Low  
**Effort:** 1 day  

- [ ] `/v2/contactPersons` Billy.dk API client
- [ ] `list_contacts`, `get_contact`, `create_contact`, `update_contact` MCP tools
- [ ] Supabase caching

---

#### **10. Recurring Invoices Endpoint** (Week 4)

**Priority:** P1 - Subscription Billing  
**Risk:** Low  
**Effort:** 1 day  

- [ ] `/v2/recurringInvoices` Billy.dk API client
- [ ] `list_recurring_invoices`, `get_recurring_invoice`, `create_recurring_invoice` MCP tools
- [ ] Supabase caching

---

#### **11. Webhook System OR Polling Sync** (Week 1-2)

**Priority:** P1 - Event-Driven Updates  
**Risk:** HIGH (Billy.dk webhook support unverified)  
**Effort:** 3 days (webhooks) OR 1 day (polling)  

**Option A: Webhooks (If Billy.dk Supports)**
- [ ] Express.js webhook receiver
- [ ] Signature verification
- [ ] Bull queue event processing
- [ ] Automatic cache updates

**Option B: Polling Sync (Fallback)**
- [ ] Cron job to check for updates
- [ ] Compare timestamps
- [ ] Update cache if changed

**⚠️ ACTION REQUIRED:**
- [ ] **Test Billy.dk API for webhook support THIS WEEK**
- [ ] Choose Option A or B based on results

---

### **🔵 MEDIUM PRIORITY (Nice-to-Have for v1.3.0)**

#### **12. Reports Endpoint** (Week 5 - If Time Allows)

**Priority:** P2 - Advanced Analytics  
**Risk:** Medium (complex data)  
**Effort:** 2 days  

- [ ] `/v2/reports` Billy.dk API client
- [ ] `get_income_statement`, `get_balance_sheet`, `get_vat_report` MCP tools

**Defer Criteria:** If Week 4 runs over schedule

---

#### **13. VAT Reports Endpoint** (Week 5 - If Time Allows)

**Priority:** P2 - Tax Compliance  
**Risk:** Low  
**Effort:** 1 day  

- [ ] `/v2/vatReports` Billy.dk API client
- [ ] `list_vat_reports`, `get_vat_report_details` MCP tools

**Defer Criteria:** If Week 4 runs over schedule

---

### **⚪ LOW PRIORITY (Defer to v1.4.0)**

#### **14. ML-Powered Cache Predictions**

**Priority:** P3 - Future Enhancement  
**Reason:** Too complex for v1.3.0, simple heuristics sufficient  
**Defer To:** v1.4.0 (Q1 2026)  

Components:
- ML predictor algorithm
- Pattern detection (hourly/daily/weekly)
- Confidence scoring
- Predictive cache warming

**Data Collection in v1.3:**
- Start tracking access logs
- Collect usage patterns
- Use for ML training in v1.4

---

#### **15. Advanced Bulk Operations**

**Priority:** P3 - Future Enhancement  
**Reason:** CSV import/export sufficient for v1.3  
**Defer To:** v1.4.0  

Components:
- Bulk invoice creation
- Bulk delete operations (too risky)
- Advanced error recovery
- Transaction rollback

---

#### **16. Unverified Billy.dk Endpoints**

**Priority:** P3 - Needs Validation  
**Reason:** Endpoint existence not confirmed  
**Defer To:** After verification in v1.4  

Endpoints to verify:
- `/v2/timeEntries`
- `/v2/projects`
- `/v2/categories`

**Action:** Test in Billy.dk sandbox, add in v1.4 if available

---

#### **17. Advanced Dashboard Features**

**Priority:** P3 - Enhanced UX  
**Reason:** MVP dashboard sufficient for v1.3  
**Defer To:** v1.4.0  

Components:
- Custom report builder
- Advanced filtering and search
- Data export to PDF
- User preferences/settings
- Multi-language support

---

## 📊 **UPDATED v1.3.0 SCOPE**

### **Revised Tool Count:**

```
v1.2.0: 13 tools
v1.3.0 Additions:
  - Bank Payments: 3 tools ✅
  - Files: 3 tools ✅
  - Bills: 3 tools ✅
  - Organizations: 2 tools ✅
  - Contacts: 4 tools ✅
  - Recurring Invoices: 3 tools ✅
  - Bulk Operations: 4 tools ✅
  - Reports: 3 tools (if time) 🔵
  - VAT Reports: 2 tools (if time) 🔵

Total v1.3.0: 20-25 tools (vs original 24)
```

### **Revised Database Schema:**

```
v1.2.0: 8 tables
v1.3.0 Additions:
  - Webhook tables: 3 ✅ (or 0 if polling)
  - Bulk ops tables: 2 ✅
  - Caching tables: 2 ✅ (simplified, no ML)

Total v1.3.0: 13-15 tables (vs original 14)
```

### **Revised Performance Targets:**

```
Response Time: <100ms average ✅ (unchanged)
Cache Hit Rate: 75-80% ✅ (revised from 85%)
API Call Reduction: 40-45% ✅ (revised from 50%)
Concurrent Users: 500 ✅ (unchanged)
```

---

## 🎯 **DECISION MATRIX**

### **Include in v1.3.0 If:**

- ✅ P0 or P1 priority
- ✅ Low to medium risk
- ✅ Clear business value
- ✅ Billy.dk endpoint confirmed
- ✅ Fits in 6-week timeline

### **Defer to v1.4.0 If:**

- ❌ P2 or P3 priority
- ❌ High risk or complexity
- ❌ Endpoint unverified
- ❌ Would delay launch
- ❌ Can be added incrementally

---

## 📅 **UPDATED TIMELINE**

### **Week 1: Core Foundation**

- Database schema ✅
- Bank Payments ✅
- Files ✅
- Webhook validation ⚠️

### **Week 2: Dashboard & Basic Endpoints**

- Analytics Dashboard MVP ✅
- Bills ✅
- Organizations ✅

### **Week 3: Bulk Operations**

- CSV import/export ✅
- Contacts ✅
- Progress tracking UI ✅

### **Week 4: Smart Caching**

- Dynamic TTL (simplified) ✅
- Recurring Invoices ✅
- Cache warming ✅

### **Week 5: Optional Additions**

- Reports (if ahead) 🔵
- VAT Reports (if ahead) 🔵
- Polish and optimization ✅

### **Week 6: Testing & Launch**

- Comprehensive testing ✅
- Bug fixes ✅
- Documentation ✅
- Production deployment ✅

---

## ✅ **APPROVAL CHECKLIST**

Before starting implementation:
- [ ] Technical review approved
- [ ] Priorities confirmed with stakeholder (you!)
- [ ] Billy.dk webhook support verified
- [ ] Redis infrastructure ready
- [ ] Development environment configured
- [ ] Week 1 tasks clearly defined

---

**Priority Plan Version:** 2.0 (Revised)  
**Last Updated:** October 14, 2025  
**Approved By:** Pending approval  
**Ready to Start:** After approval ✅
