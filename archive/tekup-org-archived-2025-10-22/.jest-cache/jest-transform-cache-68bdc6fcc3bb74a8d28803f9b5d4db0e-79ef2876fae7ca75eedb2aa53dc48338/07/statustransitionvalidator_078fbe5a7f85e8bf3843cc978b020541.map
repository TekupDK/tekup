{"version":3,"sources":["C:\\Users\\empir\\Tekup-org\\apps\\flow-api\\src\\lead\\status-transition.validator.ts"],"sourcesContent":["import { InvalidStatusTransitionError } from '../common/domain-error.js';\r\n\r\n// Explicit matrix for allowed transitions (MVP)\r\nconst ALLOWED: Record<string, string[]> = {\r\n  NEW: ['CONTACTED'],\r\n  CONTACTED: [],\r\n};\r\n\r\nexport function validateStatusTransition(from: string, to: string) {\r\n  if (from === to) {\r\n    throw new InvalidStatusTransitionError(`No-op transition ${from} -> ${to}`);\r\n  }\r\n  const allowed = ALLOWED[from] || [];\r\n  if (!allowed.includes(to)) {\r\n    throw new InvalidStatusTransitionError(`Disallowed transition ${from} -> ${to}`);\r\n  }\r\n}\r\n\r\nexport function allowedNextStatuses(from: string) {\r\n  return (ALLOWED[from] || []).slice();\r\n}"],"names":["allowedNextStatuses","validateStatusTransition","ALLOWED","NEW","CONTACTED","from","to","InvalidStatusTransitionError","allowed","includes","slice"],"mappings":";;;;;;;;;;;QAkBgBA;eAAAA;;QAVAC;eAAAA;;;6BAR6B;AAE7C,gDAAgD;AAChD,MAAMC,UAAoC;IACxCC,KAAK;QAAC;KAAY;IAClBC,WAAW,EAAE;AACf;AAEO,SAASH,yBAAyBI,IAAY,EAAEC,EAAU;IAC/D,IAAID,SAASC,IAAI;QACf,MAAM,IAAIC,yCAA4B,CAAC,CAAC,iBAAiB,EAAEF,KAAK,IAAI,EAAEC,IAAI;IAC5E;IACA,MAAME,UAAUN,OAAO,CAACG,KAAK,IAAI,EAAE;IACnC,IAAI,CAACG,QAAQC,QAAQ,CAACH,KAAK;QACzB,MAAM,IAAIC,yCAA4B,CAAC,CAAC,sBAAsB,EAAEF,KAAK,IAAI,EAAEC,IAAI;IACjF;AACF;AAEO,SAASN,oBAAoBK,IAAY;IAC9C,OAAO,AAACH,CAAAA,OAAO,CAACG,KAAK,IAAI,EAAE,AAAD,EAAGK,KAAK;AACpC"}