# Google Service Account Setup Checklist\n\n\n\n## Din Nuværende Konfiguration\n\n\n\n✅ **Project ID**: `renos-465008`✅ **Service Account Email**: `****@renos-465008.iam.gserviceaccount.com`✅ **Impersonated User**: `info@rendetalje.dk`✅ **Run Mode**: `dry-run`\n\n## Setup Status\n\n\n\nFølg denne checklist trin for trin:\n\n### 1️⃣ Google Cloud Console - Service Account Setup\n\n\n\n**URL**: <https://console.cloud.google.com/iam-admin/serviceaccounts?project=renos-465008>\n\n- [ ] **Service account eksisterer**\n\n  - Gå til linket ovenfor\n\n  - Find service account der slutter med `@renos-465008.iam.gserviceaccount.com`\n\n  - Noter **Client ID** (et langt tal - du skal bruge det i step 3)\n\n\n\n- [ ] **Domain-wide delegation er aktiveret**\n\n  - Klik på service account\n\n  - Gå til "Details" tab\n\n  - Under "Advanced settings" → "Domain-wide delegation"\n\n  - Skal være "Enabled" ✅\n\n  - Hvis ikke: Klik "Enable G Suite Domain-wide Delegation"\n\n\n\n- [ ] **APIs er aktiveret**\n\n  - Gmail API: <https://console.cloud.google.com/apis/library/gmail.googleapis.com?project=renos-465008>\n\n  - Calendar API: <https://console.cloud.google.com/apis/library/calendar-json.googleapis.com?project=renos-465008>\n\n  - Klik "Enable" på begge hvis de ikke allerede er aktiveret\n\n\n\n### 2️⃣ Få Client ID fra Service Account\n\n\n\nKør denne kommando for at finde ud af hvad din Client ID er:\n\n```powershell\n\n# Find Client ID fra service account details siden\n\n# Det er et tal på 20+ cifre, f.eks: 123456789012345678901\n\n```\n\n\n\nEller find det manuelt:\n\n1. Gå til <https://console.cloud.google.com/iam-admin/serviceaccounts?project=renos-465008>\n\n2. Klik på din service account\n\n3. Se "Unique ID" eller "OAuth 2 Client ID" - dette er din Client ID\n\n**Min Client ID**: `___________________________` ← Skriv den her\n\n### 3️⃣ Google Workspace Admin - Autorisér Scopes\n\n\n\n⚠️ **DETTE ER DET VIGTIGSTE STEP!** ⚠️\n\n\n\nDu skal være **Super Admin** i Google Workspace for at kunne gøre dette.\n\n**URL**: <https://admin.google.com/ac/owl/domainwidedelegation>Følg disse steps præcist:\n\n1. Log ind som Super Admin på <https://admin.google.com>\n\n2. Gå til **Security** → **Access and data control** → **API controls**\n\n3. Klik på **Manage Domain-wide Delegation** (nederst på siden)\n\n4. Klik **Add new** (blå knap)\n\n5. I "Client ID" feltet: Indtast Client ID fra step 2\n\n6. I "OAuth scopes" feltet: Kopier og indsæt HELE denne linje:\n\n```texthttps://www.googleapis.com/auth/gmail.modify,https://www.googleapis.com/auth/calendar,https://www.googleapis.com/auth/calendar.events,https://www.googleapis.com/auth/calendar.readonly\n\n```\n\n7. Klik **Authorize**\n\n8. Vent **5-10 minutter** for at ændringerne træder i kraft ☕\n\n\n\n- [ ] **Client ID indtastet**\n\n- [ ] **Scopes indtastet og autoriseret**\n\n- [ ] **Ventet 5-10 minutter**\n\n\n\n### 4️⃣ Verificér Brugeren <info@rendetalje.dk>\n\n\n\n- [ ] **Brugeren eksisterer** i Google Workspace\n\n  - Gå til <https://admin.google.com/ac/users>\n\n  - Søg efter "<info@rendetalje.dk>"\n\n  - Verificér at brugeren er aktiv\n\n\n\n- [ ] **Brugeren har Gmail aktiveret**\n\n  - Klik på brugeren\n\n  - Tjek at Gmail service er aktiveret\n\n\n\n- [ ] **Brugeren har Calendar adgang**\n\n  - Verificér at Google Calendar er tilgængelig for brugeren\n\n\n\n### 5️⃣ Test Forbindelsen\n\n\n\nEfter du har gennemført alle steps og ventet 5-10 minutter:\n\n```powershell\n\n# Test data fetching\n\nnpm run data:fetch\n\n```\n\nForventet output:\n\n```text🔍 RenOS Data FetcherMode: DRY-RUNService: allMax Results: 10📧 Fetching Gmail messages...Found X messages:────────────────────────────────────────────────────────────────ID: abc123From: <kunde@example.com>Subject: Test email...\n\n```\n\n- [ ] **Test kører uden fejl**\n\n- [ ] **Gmail messages vises**\n\n- [ ] **Calendar events vises**\n\n\n\n## Fejlfinding\n\n\n\n### Hvis du får "unauthorized_client" fejl igen\n\n\n\n1. **Vent længere**: Det kan tage op til 15-20 minutter i sjældne tilfælde\n\n2. **Verificer Client ID**: Sikr at du brugte det korrekte Client ID\n\n3. **Tjek scopes**: Kopier scopes præcis som vist - ingen ekstra mellemrum\n\n4. **Refresh token**:   ```powershell   # Slet eventuel cached token\n\n   Remove-Item -Path "~/.credentials" -Recurse -Force -ErrorAction SilentlyContinue\n\n   ```\n\n### Hvis du ikke kan logge ind på Admin Console\n\n\n\n- Du skal være **Super Admin** (ikke bare admin)\n\n- Kontakt din Google Workspace administrator\n\n- Alternativt: Brug en test service account med begrænsede rettigheder først\n\n\n\n### Hvis Gmail/Calendar APIs ikke kan aktiveres\n\n\n\n- Tjek at dit Google Workspace abonnement inkluderer disse APIs\n\n- Verificer at billing er aktiveret på projektet (selvom APIs er gratis)\n\n- Prøv at deaktivere og genaktivere APIs\n\n\n\n## Hvad Nu?\n\n\n\n### Når alt er sat op ✅\n\n\n\n1. **Test alle funktioner**:   ```powershell   npm run data:fetch      # Alt data\n\n   npm run data:gmail      # Kun Gmail\n\n   npm run data:calendar   # Kun Calendar\n\n   ```\n\n\n\n2. **Kør smoke test**:   ```powershell   npm run google:smoketest   ```\n\n3. **Brug i din kode**:   ```typescript   import { listRecentMessages } from "./services/gmailService";   import { listUpcomingEvents } from "./services/calendarService";      const messages = await listRecentMessages({ maxResults: 10 });   const events = await listUpcomingEvents({ maxResults: 10 });   ```\n\n### Næste Features\n\n\n\nNår data fetching virker, kan du:\n\n- [ ] Integrere Gmail data i AI chat context\n\n- [ ] Bygge email monitoring workflows\n\n- [ ] Automatisere kalender booking\n\n- [ ] Lave customer communication analytics\n\n\n\n## Hjælp Links\n\n\n\n- 📖 **Komplet guide**: [TROUBLESHOOTING_AUTH.md](./TROUBLESHOOTING_AUTH.md)\n\n- 📖 **Data fetching docs**: [DATA_FETCHING.md](./DATA_FETCHING.md)\n\n- 📖 **Quick start**: [QUICKSTART_DATA_FETCHING.md](./QUICKSTART_DATA_FETCHING.md)\n\n- 🔗 **Google Cloud Console**: <https://console.cloud.google.com/>\n\n- 🔗 **Google Admin Console**: <https://admin.google.com/>\n\n- 🔗 **Service Account Guide**: <https://developers.google.com/identity/protocols/oauth2/service-account>\n\n\n\n## Status Tracking\n\n\n\n**Setup startet**: _______________**APIs aktiveret**: _______________**Domain delegation konfigureret**: _______________**Test successful**: _______________---💡 **Tip**: Print denne checklist og afkryds hvert punkt mens du gennemfører setup!